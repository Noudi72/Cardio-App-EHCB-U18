<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Interval â€“ EHCB Cardio</title>
  <style>
    body {
      background: #181818;
      color: #fff;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    .logo {
      display: block;
      margin: 18px auto 5px auto;
      width: 80px;
      max-width: 28vw;
    }
    #backBtn {
      position: fixed;
      top: 24px;
      left: 20px;
      z-index: 9;
      border: none;
      background: #d32f2f;
      color: #fff;
      font-weight: bold;
      font-size: 1.12em;
      border-radius: 18px;
      padding: 8px 19px;
      cursor: pointer;
      box-shadow: 0 1px 9px #0002;
      transition: background 0.15s;
    }
    #backBtn:hover {
      background: #b71c1c;
    }
    h1 {
      color: #ffe028;
      text-align: center;
      margin-bottom: 0;
      font-size: 2em;
      letter-spacing: 2px;
      font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
      text-transform: uppercase;
    }
    .info-text {
      margin: 10px 0 6px 0;
      color: #ffd700;
      font-size: 1.03em;
      text-align: center;
    }
    .desc {
      text-align: center;
      margin-bottom: 16px;
      color: #ffe028;
      font-size: 0.9em;
      font-weight: 500;
    }
    .autogen-controls {
      margin-bottom: 20px;
      text-align: center;
    }
    .autogen-controls label {
      background: #232323;
      border-radius: 16px;
      padding: 8px 9px;
      margin: 0 10px 10px 0;
      display: inline-block;
      border: 1px solid #ffe028;
      font-size: 1em;
      color: #ffe028;
      cursor: default;
      user-select: none;
    }
    .autogen-controls label input {
      margin-left: 6px;
      font-size: 1em;
      border-radius: 6px;
      border: none;
      padding: 8px 9px;
      width: 4.5em;
      background: #181818;
      color: #ffe028;
      font-weight: bold;
      text-align: center;
      outline-offset: 2px;
      outline-color: #ffe028;
      outline-style: solid;
      outline-width: 1px;
      cursor: text;
    }
    .autogen-controls button {
      margin-top: 10px;
      display: block;
      background: #d32f2f;
      color: #fff;
      font-weight: bold;
      font-size: 1.11em;
      border: 2px solid #ffe028;
      border-radius: 16px;
      padding: 11px 0;
      cursor: pointer;
      box-shadow: 0 1px 6px #0002;
      transition: background 0.13s, border-color 0.13s;
      width: 160px;
      margin-left: auto;
      margin-right: auto;
    }
    .autogen-controls button:hover {
      background: #b71c1c;
      border-color: #fff100;
    }
    .phaseBox {
      margin: 44px auto 50px auto;
      max-width: 600px;
      width: 95vw;
      border-radius: 42px;
      box-shadow: 0 4px 18px #0008;
      text-align: center;
      font-size: 2.9em;
      font-weight: bold;
      padding: 44px 0 16px 0;
      min-height: 260px;
      background: #ffe028;
      color: #222;
      transition: background 0.22s, color 0.22s;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .phaseBox.work { background: #d32f2f !important; color: #fff; }
    .phaseBox.rest { background: #0cc06b !important; color: #fff; }
    .phaseBox.relax { background: #ffe028 !important; color: #222; }
    .phaseBox.prepare { background: orange !important; color: #fff; }
    .phaseLabel {
      font-size: 2.15em;
      letter-spacing: 2.5px;
      font-weight: 900;
      margin-bottom: 10px;
      text-shadow: 0 2px 8px #0003;
      font-family: 'Arial Rounded MT Bold', Arial, sans-serif;
      text-transform: uppercase;
    }
    #phaseInfo {
      font-size: 1.1em;
      font-weight: 600;
      color: inherit;
      margin-bottom: 6px;
      letter-spacing: 0.7px;
    }
    #timer {
      font-size: 6em;
      font-family: 'Consolas', 'Menlo', 'Monaco', monospace;
      font-weight: bold;
      margin: 0 0 6px 0;
      letter-spacing: 2.2px;
      text-shadow: 0 2px 10px #0002;
      line-height: 1.07;
      order: 2;
    }
    #rpmHr {
      font-size: 0.56em;
      font-weight: 600;
      color: inherit;
      margin-bottom: 6px;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 18px;
      order: 3;
      letter-spacing: 0.7px;
      word-break: break-word;
      max-width: 100%;
      box-sizing: border-box;
    }
    #rpmHr span {
      white-space: nowrap;
    }
    #phaseCount {
      font-size: 0.82em;
      margin-top: 2px;
      margin-bottom: 0;
      color: #444;
      font-weight: 600;
      opacity: 0.9;
      text-shadow: none;
      order: 4;
    }
    .cardio-buttons-row {
      display: flex;
      justify-content: space-between;
      align-items: stretch;
      width: 100%;
      max-width: 600px;
      margin: 0 auto 0 auto;
      gap: 0;
      position: relative;
      bottom: 0;
    }
    .cardio-buttons-row button {
      background: #d32f2f;
      color: #fff;
      font-weight: bold;
      font-size: 1.35em;
      border: none;
      border-radius: 0 0 32px 32px;
      padding: 20px 0 20px 0;
      cursor: pointer;
      box-shadow: 0 1px 6px #0002;
      transition: background 0.13s;
      min-width: 46%;
      max-width: 300px;
      margin: 0;
      flex: 1 1 0;
      /* Remove double border radius if only left/right: fix below per button if needed */
    }
    .cardio-buttons-row button:hover {
      background: #b71c1c;
    }
    @media (max-width: 799px) {
      .autogen-controls {
        flex-direction: column;
        align-items: center;
      }
      .autogen-controls label {
        width: 96vw;
        max-width: 500px;
        margin-left: auto;
        margin-right: 0;
        min-width: auto;
      }
      .autogen-controls button {
        margin-top: 10px;
        width: 98vw;
        max-width: 98vw;
        padding: 11px 0;
      }
      .cardio-buttons-row {
        flex-direction: column;
        width: 97vw;
        max-width: 97vw;
        gap: 6px;
        margin: 0 auto 0 auto;
      }
      .cardio-buttons-row button {
        font-size: 1.35em;
        min-width: 97vw;
        max-width: 97vw;
        border-radius: 0 0 32px 32px;
        padding: 20px 0 20px 0;
        margin-bottom: 0;
      }
      .cardio-buttons-row button + button {
        margin-top: 8px;
      }
    }
    @media (min-width: 800px) {
      .phaseBox {
        max-width: 400px;
        min-height: 150px;
        padding: 20px 0 20px 0;
        margin-top: 38px;
      }
      #timer {
        font-size: 2.65em;
        order: 2;
        margin-bottom: 6px;
      }
      .phaseLabel {
        font-size: 1.15em;
        margin-bottom: 8px;
      }
      #phaseInfo {
        font-size: 0.9em;
        margin-bottom: 6px;
      }
      #rpmHr {
        font-size: 0.65em;
        gap: 20px;
        margin-bottom: 6px;
      }
      #phaseCount {
        font-size: 0.82em;
        margin-top: 2px;
      }
    }
    @media (max-width: 600px) {
      .logo {
        margin-top: 18px;
        width: 80px;
        max-width: 28vw;
      }
      .phaseBox {
        font-size: 1.37em;
        padding: 32px 0 16px 0;
        min-height: 310px;
        max-width: 98vw;
        width: 99vw;
        border-radius: 16px;
        margin: 21px auto 10px auto;
        flex-direction: column;
        gap: 8px;
      }
      #timer {
        font-size: 3.4em;
        margin-bottom: 6px;
      }
      .phaseLabel {
        font-size: 1.05em;
        margin-bottom: 6px;
      }
      #phaseInfo {
        font-size: 1em;
        margin-bottom: 6px;
      }
      #rpmHr {
        font-size: 0.9em;
        gap: 30px;
        margin-bottom: 6px;
      }
      #phaseCount {
        font-size: 0.82em;
        margin-top: 2px;
      }
      .autogen-controls label {
        font-size: 1em;
        padding: 8px 9px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 96vw;
        max-width: 500px;
        margin-left: auto;
        margin-right: 0;
      }
      .autogen-controls label input {
        font-size: 1em;
        padding: 8px 9px;
      }
      .autogen-controls button {
        max-width: 98vw;
        padding: 11px 0;
      }
      .cardio-buttons-row {
        flex-direction: column;
        width: 97vw;
        max-width: 97vw;
        gap: 6px;
        margin: 0 auto 0 auto;
      }
      .cardio-buttons-row button {
        font-size: 1.35em;
        min-width: 97vw;
        max-width: 97vw;
        border-radius: 0 0 32px 32px;
        padding: 20px 0 20px 0;
        margin-bottom: 0;
      }
      .cardio-buttons-row button + button {
        margin-top: 8px;
      }
    }
  </style>
</head>
<body>
<button id="backBtn" onclick="window.location.href='index.html'">Back</button>
<img src="icon-cardio.png" class="logo" alt="Cardio Logo" />
<h1>Interval</h1>
<div class="info-text">Classic interval structure for maximum fat burning & endurance.</div>
<div class="desc">Set-based: Choose sets, cycles, work/rest, and relax to match your goal.</div>
<div class="autogen-controls">
  <label>Sets: <input type="number" id="setsInput" min="1" max="10" value="4"></label>
  <label>Cycles/Set: <input type="number" id="cyclesInput" min="1" max="20" value="8"></label>
  <label>Work: <input type="number" id="workInput" min="5" max="120" value="30"></label>
  <label>Rest: <input type="number" id="restInput" min="5" max="120" value="15"></label>
  <label>Relax: <input type="number" id="relaxInput" min="10" max="300" value="120"></label>
  <button onclick="autogenPhases()">Generate</button>
</div>
<div class="phaseBox prepare" id="phaseBox">
  <div class="phaseLabel" id="phaseLabel">Prepare</div>
  <div id="phaseInfo">Intensity: <b> </b> &nbsp;</div>
  <div id="timer">00:30</div>
  <div id="rpmHr"><span>RPM: <b>-</b></span><span>HR: <b>-</b>%</span></div>
  <div id="phaseCount"></div>
</div>
<div class="cardio-buttons-row" id="cardioButtonsRow">
  <button id="startBtn">Start</button>
  <button id="pauseBtn" style="display:none;">Pause</button>
  <button id="resetBtn">Reset</button>
</div>
<script>
  // ---- Default Phases Generator ----
  function generatePhases(sets, cycles, work, rest, relax) {
    const arr = [{label: "Prepare", desc: "Get Ready", duration: 30, type: "prepare", intensity: "", rpm: "-", hr: "-"}];
    for (let s = 1; s <= sets; s++) {
      for (let c = 1; c <= cycles; c++) {
        arr.push({label: "Work", desc: "High", duration: work, type: "work", intensity: "High", rpm: "100-110", hr: "85-100"});
        arr.push({label: "Rest", desc: "Low", duration: rest, type: "rest", intensity: "Low", rpm: "60-70", hr: "50-60"});
      }
      if (s !== sets) arr.push({label: "Relax", desc: "Set Pause", duration: relax, type: "relax", intensity: "Easy", rpm: "60", hr: "50"});
    }
    return arr;
  }
  // ---- End Generator ----

  let sets = 4, cycles = 8, work = 30, rest = 15, relax = 120;
  let phases = generatePhases(sets, cycles, work, rest, relax);
  let currentPhase = 0, timer = null, running = false, paused = false, t = phases[0].duration;
  let workAudioFlag = false;

  function updateUI() {
    const p = phases[currentPhase];
    const box = document.getElementById("phaseBox");
    box.className = "phaseBox " + (p.type || p.label.toLowerCase());
    document.getElementById("phaseLabel").textContent = p.label;
    document.getElementById("timer").textContent = ("0" + Math.floor(t / 60)).slice(-2) + ":" + ("0" + (t % 60)).slice(-2);
    document.getElementById("phaseInfo").innerHTML = `Intensity: <b>${p.intensity}</b>`;
    document.getElementById("rpmHr").innerHTML = ` <span>RPM: <b>${p.rpm}</b></span><span>HR: <b>${p.hr}%</b></span> `;
    document.getElementById("phaseCount").textContent = `Phase ${currentPhase + 1} of ${phases.length}`;
  }

  function playAudioSafe(audioElement) {
    if (!audioElement) return;
    const playPromise = audioElement.play();
    if (playPromise !== undefined) {
      playPromise.catch(() => {
        // Ignored: user interaction required for audio playback
      });
    }
  }

  function nextPhase() {
    if (currentPhase < phases.length - 1) {
      currentPhase++;
      t = parseInt(phases[currentPhase].duration);
      workAudioFlag = false; // reset flag on phase change
      updateUI();
      const ptype = phases[currentPhase].type || phases[currentPhase].label.toLowerCase();
      if (ptype === 'work') {
        playAudioSafe(document.getElementById('audioWork'));
      } else if (ptype === 'rest') {
        playAudioSafe(document.getElementById('audioRest'));
      }
    } else {
      running = false;
      clearInterval(timer);
      document.getElementById("startBtn").disabled = false;
      playAudioSafe(document.getElementById('audioEnd'));
      // Optional: Play session complete audio here
    }
  }

  function startProgram() {
    if (running && !paused) return;
    running = true;
    paused = false;
    document.getElementById("startBtn").disabled = true;
    document.getElementById("startBtn").textContent = "Start";
    document.getElementById("pauseBtn").style.display = "";
    document.getElementById("resetBtn").style.display = "";
    hideNonTimerUI(true);
    timer = setInterval(() => {
      t--;
      const p = phases[currentPhase];
      const ptype = p.type || p.label.toLowerCase();
      if (ptype === 'work' && t <= 4 && !workAudioFlag) {
        playAudioSafe(document.getElementById('audioRest'));
        workAudioFlag = true;
      }
      if (t < 0) {
        nextPhase();
      } else {
        updateUI();
      }
    }, 1000);
  }

  function pauseProgram() {
    if (!running || paused) return;
    paused = true;
    clearInterval(timer);
    document.getElementById("startBtn").disabled = false;
    document.getElementById("startBtn").textContent = "Resume";
    document.getElementById("pauseBtn").style.display = "none";
  }

  function resetProgram() {
    clearInterval(timer);
    running = false;
    paused = false;
    currentPhase = 0;
    t = parseInt(phases[0].duration);
    workAudioFlag = false; // reset flag on reset
    updateUI();
    document.getElementById("startBtn").disabled = false;
    document.getElementById("startBtn").textContent = "Start";
    document.getElementById("pauseBtn").style.display = "none";
    document.getElementById("resetBtn").style.display = "";
    hideNonTimerUI(false);
  }

  function hideNonTimerUI(hide) {
    // Hide .autogen-controls, .info-text, .desc, .logo if hide==true
    const elems = [
      document.querySelector('.autogen-controls'),
      document.querySelector('.info-text'),
      document.querySelector('.desc'),
      document.querySelector('.logo')
    ];
    elems.forEach(el => { if (el) el.style.display = hide ? "none" : ""; });
  }

  function autogenPhases() {
    sets = Math.max(1, parseInt(document.getElementById('setsInput').value));
    cycles = Math.max(1, parseInt(document.getElementById('cyclesInput').value));
    work = Math.max(5, parseInt(document.getElementById('workInput').value));
    rest = Math.max(5, parseInt(document.getElementById('restInput').value));
    relax = Math.max(10, parseInt(document.getElementById('relaxInput').value));
    phases = generatePhases(sets, cycles, work, rest, relax);
    resetProgram();
  }

  document.getElementById("startBtn").onclick = function() {
    if (paused) {
      startProgram();
    } else {
      startProgram();
    }
  };
  document.getElementById("pauseBtn").onclick = pauseProgram;
  document.getElementById("resetBtn").onclick = resetProgram;

  // On load, show only Start and Reset, hide Pause
  document.getElementById("pauseBtn").style.display = "none";
  updateUI();

  // --- Optional: Add Audio triggers (left as comment for you to add your mp3/ogg files) ---
  /*
  function playAudio(phaseType) {
    // if (phaseType === 'work') document.getElementById('audioWork').play();
    // if (phaseType === 'rest') document.getElementById('audioRest').play();
    // if (phaseType === 'relax') document.getElementById('audioRelax').play();
    // if (phaseType === 'prepare') document.getElementById('audioPrepare').play();
    // if (phaseType === 'end') document.getElementById('audioEnd').play();
  }
  */
</script>
<audio id="audioWork" src="start_work.m4a"></audio>
<audio id="audioRest" src="Rest.m4a"></audio>
<audio id="audioEnd" src="Session Complete.m4a"></audio>
</body>
</html>